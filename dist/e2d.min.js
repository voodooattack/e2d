!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.e2d=t()}}(function(){return function t(e,i,n){function r(o,a){if(!i[o]){if(!e[o]){var c="function"==typeof require&&require;if(!a&&c)return c(o,!0);if(s)return s(o,!0);var h=Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var u=i[o]={exports:{}};e[o][0].call(u.exports,function(t){var i=e[o][1][t];return r(i?i:t)},u,u.exports,t,e,i,n)}return i[o].exports}for(var s="function"==typeof require&&require,o=0;o<n.length;o++)r(n[o]);return r}({1:[function(t,e){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function r(t){return"number"==typeof t}function s(t){return"object"==typeof t&&null!==t}function o(t){return void 0===t}e.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(t){if(!r(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},i.prototype.emit=function(t){var e,i,r,a,c,h;if(this._events||(this._events={}),"error"===t&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.')}if(i=this._events[t],o(i))return!1;if(n(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,a=Array(r-1),c=1;r>c;c++)a[c-1]=arguments[c];i.apply(this,a)}else if(s(i)){for(r=arguments.length,a=Array(r-1),c=1;r>c;c++)a[c-1]=arguments[c];for(h=i.slice(),r=h.length,c=0;r>c;c++)h[c].apply(this,a)}return!0},i.prototype.addListener=function(t,e){var r;if(!n(e))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?s(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,s(this._events[t])&&!this._events[t].warned){var r;r=o(this._maxListeners)?i.defaultMaxListeners:this._maxListeners,r&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())}return this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){function i(){this.removeListener(t,i),r||(r=!0,e.apply(this,arguments))}if(!n(e))throw TypeError("listener must be a function");var r=!1;return i.listener=e,this.on(t,i),this},i.prototype.removeListener=function(t,e){var i,r,o,a;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(i=this._events[t],o=i.length,r=-1,i===e||n(i.listener)&&i.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(s(i)){for(a=o;a-->0;)if(i[a]===e||i[a].listener&&i[a].listener===e){r=a;break}if(0>r)return this;1===i.length?(i.length=0,delete this._events[t]):i.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},i.prototype.removeAllListeners=function(t){var e,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[t],n(i))this.removeListener(t,i);else for(;i.length;)this.removeListener(t,i[i.length-1]);return delete this._events[t],this},i.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},i.listenerCount=function(t,e){var i;return i=t._events&&t._events[e]?n(t._events[e])?1:t._events[e].length:0}},{}],2:[function(t,e){e.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},{}],3:[function(t,e,i){(function(t){function e(t,e){for(var i=0,n=t.length-1;n>=0;n--){var r=t[n];"."===r?t.splice(n,1):".."===r?(t.splice(n,1),i++):i&&(t.splice(n,1),i--)}if(e)for(;i--;i)t.unshift("..");return t}function n(t,e){if(t.filter)return t.filter(e);for(var i=[],n=0;n<t.length;n++)e(t[n],n,t)&&i.push(t[n]);return i}var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,s=function(t){return r.exec(t).slice(1)};i.resolve=function(){for(var i="",r=!1,s=arguments.length-1;s>=-1&&!r;s--){var o=0>s?t.cwd():arguments[s];if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(i=o+"/"+i,r="/"===o.charAt(0))}return i=e(n(i.split("/"),function(t){return!!t}),!r).join("/"),(r?"/":"")+i||"."},i.normalize=function(t){var r=i.isAbsolute(t),s="/"===o(t,-1);return t=e(n(t.split("/"),function(t){return!!t}),!r).join("/"),t||r||(t="."),t&&s&&(t+="/"),(r?"/":"")+t},i.isAbsolute=function(t){return"/"===t.charAt(0)},i.join=function(){var t=Array.prototype.slice.call(arguments,0);return i.normalize(n(t,function(t){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},i.relative=function(t,e){function n(t){for(var e=0;e<t.length&&""===t[e];e++);for(var i=t.length-1;i>=0&&""===t[i];i--);return e>i?[]:t.slice(e,i-e+1)}t=i.resolve(t).substr(1),e=i.resolve(e).substr(1);for(var r=n(t.split("/")),s=n(e.split("/")),o=Math.min(r.length,s.length),a=o,c=0;o>c;c++)if(r[c]!==s[c]){a=c;break}for(var h=[],c=a;c<r.length;c++)h.push("..");return h=h.concat(s.slice(a)),h.join("/")},i.sep="/",i.delimiter=":",i.dirname=function(t){var e=s(t),i=e[0],n=e[1];return i||n?(n&&(n=n.substr(0,n.length-1)),i+n):"."},i.basename=function(t,e){var i=s(t)[2];return e&&i.substr(-1*e.length)===e&&(i=i.substr(0,i.length-e.length)),i},i.extname=function(t){return s(t)[3]};var o="b"==="ab".substr(-1)?function(t,e,i){return t.substr(e,i)}:function(t,e,i){return 0>e&&(e=t.length+e),t.substr(e,i)}}).call(this,t("_process"))},{_process:4}],4:[function(t,e){function i(){h=!1,o.length?c=o.concat(c):u=-1,c.length&&n()}function n(){if(!h){var t=setTimeout(i);h=!0;for(var e=c.length;e;){for(o=c,c=[];++u<e;)o[u].run();u=-1,e=c.length}o=null,h=!1,clearTimeout(t)}}function r(t,e){this.fun=t,this.array=e}function s(){}var o,a=e.exports={},c=[],h=!1,u=-1;a.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];c.push(new r(t,e)),1!==c.length||h||setTimeout(n,0)},r.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=s,a.addListener=s,a.once=s,a.off=s,a.removeListener=s,a.removeAllListeners=s,a.emit=s,a.binding=function(){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(){throw Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],5:[function(t,e){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],6:[function(t,e,i){(function(e,n){function r(t,e){var n={seen:[],stylize:o};return arguments.length<3||(n.depth=arguments[2]),arguments.length<4||(n.colors=arguments[3]),g(e)?n.showHidden=e:e&&i._extend(n,e),b(n.showHidden)&&(n.showHidden=!1),b(n.depth)&&(n.depth=2),b(n.colors)&&(n.colors=!1),b(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=s),c(n,t,n.depth)}function s(t,e){var i=r.styles[e];return i?"["+r.colors[i][0]+"m"+t+"["+r.colors[i][1]+"m":t}function o(t){return t}function a(t){var e={};return t.forEach(function(t){e[t]=!0}),e}function c(t,e,n){if(t.customInspect&&e&&O(e.inspect)&&e.inspect!==i.inspect&&(!e.constructor||e.constructor.prototype!==e)){var r=e.inspect(n,t);return x(r)||(r=c(t,r,n)),r}var s=h(t,e);if(s)return s;var o=Object.keys(e),g=a(o);if(t.showHidden&&(o=Object.getOwnPropertyNames(e)),_(e)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return u(e);if(0===o.length){if(O(e)){var v=e.name?": "+e.name:"";return t.stylize("[Function"+v+"]","special")}if(S(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(I(e))return t.stylize(Date.prototype.toString.call(e),"date");if(_(e))return u(e)}var y="",m=!1,w=["{","}"];if(p(e)&&(m=!0,w=["[","]"]),O(e)){var b=e.name?": "+e.name:"";y=" [Function"+b+"]"}if(S(e)&&(y=" "+RegExp.prototype.toString.call(e)),I(e)&&(y=" "+Date.prototype.toUTCString.call(e)),_(e)&&(y=" "+u(e)),0===o.length&&(!m||0==e.length))return w[0]+y+w[1];if(0>n)return S(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var k;return k=m?l(t,e,n,g,o):o.map(function(i){return d(t,e,n,g,i,m)}),t.seen.pop(),f(k,y,w)}function h(t,e){if(b(e))return t.stylize("undefined","undefined");if(x(e)){var i="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(i,"string")}return m(e)?t.stylize(""+e,"number"):g(e)?t.stylize(""+e,"boolean"):v(e)?t.stylize("null","null"):void 0}function u(t){return"["+Error.prototype.toString.call(t)+"]"}function l(t,e,i,n,r){for(var s=[],o=0,a=e.length;a>o;++o)s.push(T(e,o+"")?d(t,e,i,n,o+"",!0):"");return r.forEach(function(r){r.match(/^\d+$/)||s.push(d(t,e,i,n,r,!0))}),s}function d(t,e,i,n,r,s){var o,a,h;if(h=Object.getOwnPropertyDescriptor(e,r)||{value:e[r]},h.get?a=h.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):h.set&&(a=t.stylize("[Setter]","special")),T(n,r)||(o="["+r+"]"),a||(t.seen.indexOf(h.value)<0?(a=v(i)?c(t,h.value,null):c(t,h.value,i-1),a.indexOf("\n")>-1&&(a=s?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n"))):a=t.stylize("[Circular]","special")),b(o)){if(s&&r.match(/^\d+$/))return a;o=JSON.stringify(""+r),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=t.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=t.stylize(o,"string"))}return o+": "+a}function f(t,e,i){var n=0,r=t.reduce(function(t,e){return n++,e.indexOf("\n")<0||n++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return r>60?i[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+i[1]:i[0]+e+" "+t.join(", ")+" "+i[1]}function p(t){return Array.isArray(t)}function g(t){return"boolean"==typeof t}function v(t){return null===t}function y(t){return null==t}function m(t){return"number"==typeof t}function x(t){return"string"==typeof t}function w(t){return"symbol"==typeof t}function b(t){return void 0===t}function S(t){return k(t)&&"[object RegExp]"===A(t)}function k(t){return"object"==typeof t&&null!==t}function I(t){return k(t)&&"[object Date]"===A(t)}function _(t){return k(t)&&("[object Error]"===A(t)||t instanceof Error)}function O(t){return"function"==typeof t}function L(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t}function A(t){return Object.prototype.toString.call(t)}function P(t){return 10>t?"0"+t.toString(10):t.toString(10)}function C(){var t=new Date,e=[P(t.getHours()),P(t.getMinutes()),P(t.getSeconds())].join(":");return[t.getDate(),H[t.getMonth()],e].join(" ")}function T(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var E=/%[sdj%]/g;i.format=function(t){if(!x(t)){for(var e=[],i=0;i<arguments.length;i++)e.push(r(arguments[i]));return e.join(" ")}for(var i=1,n=arguments,s=n.length,o=(t+"").replace(E,function(t){if("%%"===t)return"%";if(i>=s)return t;switch(t){case"%s":return n[i++]+"";case"%d":return+n[i++];case"%j":try{return JSON.stringify(n[i++])}catch(e){return"[Circular]"}default:return t}}),a=n[i];s>i;a=n[++i])o+=v(a)||!k(a)?" "+a:" "+r(a);return o},i.deprecate=function(t,r){function s(){if(!o){if(e.throwDeprecation)throw Error(r);e.traceDeprecation?console.trace(r):console.error(r),o=!0}return t.apply(this,arguments)}if(b(n.process))return function(){return i.deprecate(t,r).apply(this,arguments)};if(e.noDeprecation===!0)return t;var o=!1;return s};var R,M={};i.debuglog=function(t){if(b(R)&&(R=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!M[t])if(RegExp("\\b"+t+"\\b","i").test(R)){var n=e.pid;M[t]=function(){var e=i.format.apply(i,arguments);console.error("%s %d: %s",t,n,e)}}else M[t]=function(){};return M[t]},i.inspect=r,r.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},i.isArray=p,i.isBoolean=g,i.isNull=v,i.isNullOrUndefined=y,i.isNumber=m,i.isString=x,i.isSymbol=w,i.isUndefined=b,i.isRegExp=S,i.isObject=k,i.isDate=I,i.isError=_,i.isFunction=O,i.isPrimitive=L,i.isBuffer=t("./support/isBuffer");var H=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];i.log=function(){console.log("%s - %s",C(),i.format.apply(i,arguments))},i.inherits=t("inherits"),i._extend=function(t,e){if(!e||!k(e))return t;for(var i=Object.keys(e),n=i.length;n--;)t[i[n]]=e[i[n]];return t}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":5,_process:4,inherits:2}],7:[function(t,e){"use strict";e.exports={addColorStop:t("./src/addColorStop"),arc:t("./src/arc"),arcTo:t("./src/arcTo"),beginPath:t("./src/beginPath"),bezierCurveTo:t("./src/bezierCurveTo"),Canvas:t("./src/Canvas"),clearRect:t("./src/clearRect"),clip:t("./src/clip"),clipPath:t("./src/clipPath"),closePath:t("./src/closePath"),createLinearGradient:t("./src/createLinearGradient"),createRadialGradient:t("./src/createRadialGradient"),drawCanvas:t("./src/drawCanvas"),drawImage:t("./src/drawImage"),ellipse:t("./src/ellipse"),fill:t("./src/fill"),fillArc:t("./src/fillArc"),fillCanvas:t("./src/fillCanvas"),fillImage:t("./src/fillImage"),fillImagePattern:t("./src/fillImagePattern"),fillRect:t("./src/fillRect"),fillStyle:t("./src/fillStyle"),globalAlpha:t("./src/globalAlpha"),globalCompositeOperation:t("./src/globalCompositeOperation"),Gradient:t("./src/Gradient"),hitRect:t("./src/hitRect"),hitRegion:t("./src/hitRegion"),Img:t("./src/Img"),Instruction:t("./src/Instruction"),isDataUrl:t("./src/isDataUrl"),isWorker:t("./src/isWorker"),lineStyle:t("./src/lineStyle"),lineTo:t("./src/lineTo"),moveTo:t("./src/moveTo"),path:t("./src/path"),quadraticCurveTo:t("./src/quadraticCurveTo"),rect:t("./src/rect"),Renderer:t("./src/Renderer"),rotate:t("./src/rotate"),scale:t("./src/scale"),shadowStyle:t("./src/shadowStyle"),stroke:t("./src/stroke"),strokeArc:t("./src/strokeArc"),strokeRect:t("./src/strokeRect"),strokeStyle:t("./src/strokeStyle"),text:t("./src/text"),textStyle:t("./src/textStyle"),transform:t("./src/transform"),transformPoints:t("./src/transformPoints"),translate:t("./src/translate")}},{"./src/Canvas":10,"./src/Gradient":11,"./src/Img":12,"./src/Instruction":13,"./src/Renderer":14,"./src/addColorStop":15,"./src/arc":16,"./src/arcTo":17,"./src/beginPath":18,"./src/bezierCurveTo":19,"./src/clearRect":20,"./src/clip":21,"./src/clipPath":22,"./src/closePath":23,"./src/createLinearGradient":24,"./src/createRadialGradient":25,"./src/drawCanvas":26,"./src/drawImage":27,"./src/ellipse":28,"./src/fill":29,"./src/fillArc":30,"./src/fillCanvas":31,"./src/fillImage":32,"./src/fillImagePattern":33,"./src/fillRect":34,"./src/fillStyle":35,"./src/globalAlpha":36,"./src/globalCompositeOperation":37,"./src/hitRect":38,"./src/hitRegion":39,"./src/isDataUrl":41,"./src/isWorker":42,"./src/lineStyle":43,"./src/lineTo":44,"./src/moveTo":45,"./src/path":46,"./src/quadraticCurveTo":47,"./src/rect":48,"./src/rotate":49,"./src/scale":50,"./src/shadowStyle":51,"./src/stroke":52,"./src/strokeArc":53,"./src/strokeRect":54,"./src/strokeStyle":55,"./src/text":56,"./src/textStyle":57,"./src/transform":58,"./src/transformPoints":59,"./src/translate":60}],8:[function(t,e,i){i=e.exports=function(t){if(t&&"object"==typeof t){var e=t.which||t.keyCode||t.charCode;e&&(t=e)}if("number"==typeof t)return o[t];var i=t+"",s=n[i.toLowerCase()];if(s)return s;var s=r[i.toLowerCase()];return s?s:1===i.length?i.charCodeAt(0):void 0};var n=i.code=i.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"right click":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},r=i.aliases={windows:91,"â‡§":16,"âŒ¥":18,"âŒƒ":17,"âŒ˜":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,pgup:33,pgdn:33,ins:45,del:46,cmd:91};/*!
 * Programatically add the following
 */
for(s=97;123>s;s++)n[String.fromCharCode(s)]=s-32;for(var s=48;58>s;s++)n[s-48]=s;for(s=1;13>s;s++)n["f"+s]=s+111;for(s=0;10>s;s++)n["numpad "+s]=s+96;var o=i.names=i.title={};for(s in n)o[n[s]]=s;for(var a in r)n[a]=r[a]},{}],9:[function(t,e){e.exports=function(t,e){for(var i=t[0],n=t[1],r=!1,s=0,o=e.length-1;s<e.length;o=s++){var a=e[s][0],c=e[s][1],h=e[o][0],u=e[o][1],l=c>n!=u>n&&(h-a)*(n-c)/(u-c)+a>i;l&&(r=!r)}return r}},{}],10:[function(t,e){"use strict";function i(e,r,o){this.id=o||s(),this.width=e,this.height=r;var a=t("./Renderer");n?(postMessage({type:"canvas",value:{id:this.id,width:this.width,height:this.height,children:[]}}),this.renderer=null):this.renderer=new a(e,r,document.createElement("div")),this.fillPattern=null,i.cache[this.id]=this,Object.seal(this)}var n=t("./isWorker"),r=t("./Img"),s=t("./id");i.prototype.render=function(){var t,e,i,r=[],s=r.concat;for(t=0;t<arguments.length;t++)r.push(arguments[t]);for(t=0,e=r.length;e>t;t++)if(i=r[t],i&&i.constructor===Array){for(r=s.apply([],r),i=r[t];i&&i.constructor===Array;)r=s.apply([],r),i=r[t];e=r.length}n?postMessage({type:"canvas",value:{id:this.id,width:this.width,height:this.height,children:r}}):(this.renderer.render(r),this.fillPattern=this.renderer.ctx.createPattern(this.renderer.canvas,"no-repeat"))},i.prototype.toImage=function(t){var e;return e=new r(t||s()),n?(postMessage({type:"canvas-image",value:{id:this.id,imageID:t}}),e):(e.src=this.renderer.canvas.toDataURL("image/png"),e)},i.prototype.dispose=function(){if(n)return postMessage({type:"canvas-dispose",value:{id:this.id}});i.cache[this.id]=null;var t=i.cachable.indexOf(this.id);t>-1&&i.cachable.splice(t,1)},i.prototype.cache=function(){if(n)return postMessage({type:"canvas-cache",value:{id:this.id}});var t=i.cachable.indexOf(this.id);return-1===t&&i.cachable.push(this.id),this},i.cleanUp=function(){for(var t,e={},n=0;n<i.cachable.length;n++)t=i.cachable[n],e[t]=i.cache[t];i.cache=e},i.prototype.resize=function(t,e){return this.renderer.resize(t,e)},i.cache={},i.cachable=[],i.create=function(t,e,n){return new i(t,e,n)},Object.seal(i),Object.seal(i.prototype),e.exports=i},{"./Img":12,"./Renderer":14,"./id":40,"./isWorker":42}],11:[function(t,e){"use strict";function i(t,e){this.id=t,this.grd=e,i.cache[t]=this,Object.seal(this)}var n=t("./isWorker");i.cache={},i.cachable=[],i.prototype.cache=function(){return n?postMessage({type:"gradient-cache",value:{id:this.id}}):i.cachable.push(this.id),this},i.prototype.dispose=function(){if(n)return postMessage({type:"gradient-dispose",value:{id:this.id}});i.cache[this.id]=null;var t=i.cachable.indexOf(this.id);-1!==t&&i.cachable.splice(t,1)},i.cleanUp=function(){for(var t,e={},n=0;n<i.cachable.length;n++)t=i.cachable[n],e[t]=i.cache[t];i.cache=e},Object.seal(i),Object.seal(i.prototype),e.exports=i},{"./isWorker":42}],12:[function(t,e){"use strict";function i(t){s.EventEmitter.call(this),this._src="",this.isDataUrl=!1,this.id=t||a(),this.buffer=new ArrayBuffer,this.onload=function(){},this.texture=null,this.type="image",this.blobOptions={},this.imageElement=null,this.imagePattern=null,this.imagePatternRepeat=null,n&&postMessage({type:"image",value:{id:this.id,src:""}}),Object.seal(this)}var n=(t("path"),t("./isWorker")),r=t("./isDataUrl"),s=t("events"),o=t("util"),a=t("./id");o.inherits(i,s.EventEmitter),i.cache={},i.cachable=[],Object.defineProperty(i.prototype,"src",{set:function(t){if(this.isDataUrl=r(t),n)return i.cache[this.id]=this,void postMessage({type:"image-source",value:{id:this.id,src:t}});var e=new Image;this.imageElement=e,e.src=t,e.onload=this.imageLoad.bind(this)},get:function(){return this._src}}),i.prototype.imageLoad=function(){if(!n){var t=document.createElement("canvas").getContext("2d");this.imagePattern=t.createPattern(this.imageElement,"no-repeat"),this.imagePatternRepeat=t.createPattern(this.imageElement,"repeat")}return i.cache[this.id]=this,this.emit("load",this)},i.prototype.cache=function(){return n?postMessage({type:"image-cache",value:{id:this.id}}):i.cachable.push(this.id),this},i.prototype.dispose=function(){if(n)return postMessage({type:"image-dispose",value:{id:this.id}});i.cache[this.id]=null;var t=i.cachable.indexOf(this.id);-1!==t&&i.cachable.splice(t,1)},Object.defineProperty(i.prototype,"width",{enumerable:!0,get:function(){return this.texture.width},set:function(t){this.texture.width=t}}),Object.defineProperty(i.prototype,"height",{enumerable:!0,get:function(){return this.texture.height},set:function(t){this.texture.height=t}}),i.cleanUp=function(){for(var t,e={},n=0;n<i.cachable.length;n++)t=i.cachable[n],e[t]=i.cache[t];i.cache=e},Object.seal(i),Object.seal(i.prototype),e.exports=i},{"./id":40,"./isDataUrl":41,"./isWorker":42,events:1,path:3,util:6}],13:[function(t,e){"use strict";function i(t,e){this.type=t,this.props=e,Object.seal(this)}Object.seal(i),Object.seal(i.prototype),e.exports=i},{}],14:[function(t,e){"use strict";function i(e,i,o,a){return c.EventEmitter.call(this),n||(n=t("./Canvas")),r||(r=t("./Gradient")),u||(r=t("./Gradient")),this.tree=null,this.isReady=!1,this.mouseState="up",this.mouseData={x:0,y:0,state:this.mouseState,activeRegions:[]},this.lastMouseEvent=null,this.ranMouseEvent=!1,this.mouseRegions=[],this.activeRegions=[],this.styleQueue=[],this.keyData={},s?(this.worker=null,this.canvas=null,this.ctx=null,this.parent=null,addEventListener("message",this.browserCommand.bind(this)),void Object.seal(this)):(a?(this.worker=a instanceof Worker?a:new Worker(a),this.worker.onmessage=this.workerCommand.bind(this)):this.worker=null,o&&1===o.nodeType?this.parent=o:(this.parent=document.createElement("div"),this.parent.style.margin="0 auto",this.parent.style.width=e+"px",this.parent.style.height=i+"px",document.body.appendChild(this.parent)),e&&e>0||(e=window.innerWidth),i&&i>0||(i=window.innerHeight),this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=e,this.canvas.height=i,this.parent.appendChild(this.canvas),this.hookMouseEvents(),this.hookKeyboardEvents(),void Object.seal(this))}var n=null,r=null,s=t("./isWorker"),o=t("./createLinearGradient"),a=t("./createRadialGradient"),c=t("events"),h=t("util"),u=t("./Img"),l=t("keycode"),d=t("./transformPoints"),f=t("point-in-polygon"),p=2*Math.PI,g=new Float64Array([1,0,0,1,0,0]),v=t("./id");h.inherits(i,c.EventEmitter),i.prototype.render=function(){var t,e,i,o,a,c,h,l,f,v=[],y=[],m=[],x=[],w=[],b=[],S=[g],k=[],I=this.ctx,_=[],O=_.concat;for(t=0,e=arguments.length;e>t;t++)_.push(arguments[t]);if(s)return this.sendBrowser("render",_);for(t=0,e=_.length;e>t;t++){if(i=_[t],i&&i.constructor===Array){for(_=O.apply([],_),i=_[t];i&&i.constructor===Array;)_=O.apply([],_),i=_[t];e=_.length}if(i)if(o=i.props,a=i.type,"transform"!==a)if("scale"!==a)if("translate"!==a)if("rotate"!==a)if("restore"!==a)if("fillRect"!==a)if("strokeRect"!==a)if("clearRect"!==a)if("rect"!==a)if("fillStyle"!==a)if("fillGradient"!=a)if("strokeStyle"!==a)if("strokeGradient"!=a)if("endFillStyle"!==a)if("endStrokeStyle"!==a)if("lineStyle"!==a)if("endLineStyle"!==a)if("textStyle"!==a)if("endTextStyle"!==a)if("shadowStyle"!==a)if("endShadowStyle"!==a)if("text"!==a)if("drawImage"!==a)if("drawImageSize"!==a)if("drawImageSource"!==a)if("fillImagePattern"!==a)if("fillImage"!==a)if("fillImageSize"!==a)if("fillImageSource"!==a)if("fillCanvas"!==a)if("fillCanvasSize"!==a)if("fillCanvasSource"!==a)if("drawCanvas"!==a)if("drawCanvasSize"!==a)if("drawCanvasSource"!==a)"strokeArc"!==a?"strokeArc-counterclockwise"!==a?"fillArc"!==a&&"fillArc-counterclockwise"!==a?"moveTo"!==a?"lineTo"!==a?"bezierCurveTo"!==a?"quadraticCurveTo"!==a?"anticlockwise-arc"!==a?"arc"!==a?"full-arc"!==a?"quick-arc"!==a?"arcTo"!==a?"anticlockwise-ellipse"!==a?"ellipse"!==a?"full-ellipse"!==a?"quick-ellipse"!==a?"globalCompositeOperation"!==a?"endGlobalCompositeOperation"!==a?"fill"!==a?"stroke"!==a?"clipPath"!==a?"beginPath"!==a?"closePath"!==a?"globalAlpha"!==a?"endGlobalAlpha"!==a?"hitRegion"!==a||this.mouseRegions.push({id:o.id,points:d(o.points,S[S.length-1])}):I.globalAlpha=b.pop():(b.push(I.globalAlpha),I.globalAlpha*=o.value):I.closePath():I.beginPath():I.clip():I.stroke():I.fill():I.globalCompositeOperation=k.pop():(k.push(I.globalCompositeOperation),I.globalCompositeOperation=o.value):(this.save(),this.translate(o.x,o.y),this.scale(o.radiusX,o.radiusY),this.arc(0,0,1,0,p),this.restore()):(this.save(),this.translate(o.x,o.y),this.rotate(o.rotation),this.scale(o.radiusX,o.radiusY),this.arc(0,0,1,0,p),this.restore()):(this.save(),this.translate(o.x,o.y),this.rotate(o.rotation),this.scale(o.radiusX,o.radiusY),this.arc(0,0,1,o.startAngle,o.endAngle),this.restore()):(this.save(),this.translate(o.x,o.y),this.rotate(o.rotation),this.scale(o.radiusX,o.radiusY),this.arc(0,0,1,o.startAngle,o.endAngle,!0),this.restore()):I.arcTo(o.x1,o.y1,o.x2,o.y2,o.r):I.arc(0,0,o.r,0,p):I.arc(o.x,o.y,o.r,0,p):I.arc(o.x,o.y,o.r,o.startAngle,o.endAngle):I.arc(o.x,o.y,o.r,o.startAngle,o.endAngle,!0):I.quadraticCurveTo(o.cpx,o.cpy,o.x,o.y):I.bezierCurveTo(o.cp1x,o.cp1y,o.cp2x,o.cp2y,o.x,o.y):I.lineTo(o.x,o.y):I.moveTo(o.x,o.y):(I.beginPath(),I.arc(o.x,o.y,o.r,o.startAngle,o.endAngle),I.closePath(),I.fill()):(I.beginPath(),I.arc(o.x,o.y,o.r,o.startAngle,o.endAngle,!0),I.closePath(),I.stroke()):(I.beginPath(),I.arc(o.x,o.y,o.r,o.startAngle,o.endAngle),I.closePath(),I.stroke());else{if(!n.cache.hasOwnProperty(o.img))continue;I.drawImage(n.cache[o.img].renderer.canvas,o.sx,o.sy,o.sWidth,o.sHeight,o.dx,o.dy,o.dWidth,o.dHeight)}else{if(!n.cache.hasOwnProperty(o.img))continue;I.drawImage(n.cache[o.img].renderer.canvas,o.dx,o.dy,o.dWidth,o.dHeight)}else{if(!n.cache.hasOwnProperty(o.img))continue;I.drawImage(n.cache[o.img].renderer.canvas,o.dx,o.dy)}else{if(!n.cache.hasOwnProperty(o.img))continue;c=n.cache[o.img],I.save(),I.fillStyle=c.fillPattern,I.translate(o.dx,o.dy),I.scale(c.width/o.sWidth,c.height/o.sHeight),I.translate(-o.sx,-o.sy),I.fillRect(o.sx,o.sy,o.sWidth,o.sHeight),I.restore()}else{if(!n.cache.hasOwnProperty(o.img))continue;c=n.cache[o.img],I.save(),I.fillStyle=c.fillPattern,I.translate(o.dx,o.dy),I.scale(o.dWidth/c.width,o.dHeight/c.height),I.fillRect(0,0,c.width,c.height),I.restore()}else{if(!n.cache.hasOwnProperty(o.img))continue;c=n.cache[o.img],I.save(),I.fillStyle=c.fillPattern,I.translate(o.dx,o.dy),I.fillRect(0,0,c.width,c.height),I.restore()}else{if(!u.cache.hasOwnProperty(o.img))continue;c=u.cache[o.img].imageElement,I.save(),I.fillStyle=u.cache[o.img].imagePattern,I.translate(o.dx,o.dy),I.scale(c.dWidth/o.sWidth,c.dHeight/o.sHeight),I.translate(-o.sx,-o.sy),I.fillRect(o.sx,o.sy,o.sWidth,o.sHeight),I.restore()}else{if(!u.cache.hasOwnProperty(o.img))continue;c=u.cache[o.img].imageElement,I.save(),I.fillStyle=u.cache[o.img].imagePattern,I.translate(o.dx,o.dy),I.scale(o.dWidth/c.width,o.dHeight/c.height),I.fillRect(0,0,c.width,c.height),I.restore()}else{if(!u.cache.hasOwnProperty(o.img))continue;c=u.cache[o.img].imageElement,I.save(),I.fillStyle=u.cache[o.img].imagePattern,I.translate(o.dx,o.dy),I.fillRect(0,0,c.width,c.height),I.restore()}else{if(!u.cache.hasOwnProperty(o.img))continue;I.fillStyle=u.cache[o.img].imagePatternRepeat,I.translate(o.dx,o.dy),I.fillRect(0,0,o.dWidth,o.dHeight),I.restore()}else{if(!u.cache.hasOwnProperty(o.img))continue;I.drawImage(u.cache[o.img].imageElement||new Image,o.sx,o.sy,o.sWidth,o.sHeight,o.dx,o.dy,o.dWidth,o.dHeight)}else{if(!u.cache.hasOwnProperty(o.img))continue;I.drawImage(u.cache[o.img].imageElement||new Image,o.dx,o.dy,o.dWidth,o.dHeight)}else{if(!u.cache.hasOwnProperty(o.img))continue;I.drawImage(u.cache[o.img].imageElement||new Image,o.dx,o.dy)}else{if(0!==o.maxWidth){o.fill&&I.fillText(o.text,o.x,o.y,o.maxWidth),o.stroke&&I.strokeText(o.text,o.x,o.y,o.maxWidth);continue}o.fill&&I.fillText(o.text,o.x,o.y),o.stroke&&I.strokeText(o.text,o.x,o.y)}else c=w.pop(),I.shadowBlur=c.shadowBlur,I.shadowColor=c.shadowColor,I.shadowOffsetX=c.shadowOffsetX,I.shadowOffsetY=c.shadowOffsetY;else w.push({shadowBlur:I.shadowBlur,shadowColor:I.shadowColor,shadowOffsetX:I.shadowOffsetX,shadowOffsetY:I.shadowOffsetY}),null!==o.shadowBlur&&(I.shadowBlur=o.shadowBlur),null!==o.shadowColor&&(I.shadowColor=o.shadowColor),null!==o.shadowOffsetX&&(I.shadowOffsetX=o.shadowOffsetX),null!==o.shadowOffsetY&&(I.shadowOffsetY=o.shadowOffsetY);else c=x.pop(),I.font=c.font,I.textAlign=c.textAlign,I.textBaseline=c.textBaseline,I.direction=c.direction;else x.push({font:I.font,textAlign:I.textAlign,textBaseline:I.textBaseline,direction:I.direction}),null!==o.font&&(I.font=o.font),null!==o.textAlign&&(I.textAlign=o.textAlign),null!==o.textBaseline&&(I.textBaseline=o.textBaseline),null!==o.lineJoin&&(I.direction=o.direction);else c=m.pop(),I.lineWidth=c.lineWidth,I.lineCap=c.lineCap,I.lineJoin=c.lineJoin,I.miterLimit=c.miterLimit,I.setLineDash(c.lineDash),I.lineDashOffset=c.lineDashOffset;else m.push({lineWidth:I.lineWidth,lineCap:I.lineCap,lineJoin:I.lineJoin,miterLimit:I.miterLimit,lineDash:I.getLineDash(),lineDashOffset:I.lineDashOffset}),null!==o.lineWidth&&(I.lineWidth=o.lineWidth),null!==o.lineCap&&(I.lineCap=o.lineCap),null!==o.lineJoin&&(I.lineJoin=o.lineJoin),null!==o.miterLimit&&(I.miterLimit=o.miterLimit),o.lineDash.length>0&&I.setLineDash(o.lineDash),null!==o.lineDashOffset&&(I.lineDashOffset=o.lineDashOffset);else I.strokeStyle=y.pop();else I.fillStyle=v.pop();else y.push(I.strokeStyle),r.cache.hasOwnProperty(o.value.id)&&(I.strokeStyle=r.cache[o.value.id].grd);else y.push(I.strokeStyle),I.strokeStyle=o.value;else v.push(I.fillStyle),r.cache.hasOwnProperty(o.value.id)&&(I.fillStyle=r.cache[o.value.id].grd);else v.push(I.fillStyle),I.fillStyle=o.value;else I.rect(o.x,o.y,o.width,o.height);else I.clearRect(o.x,o.y,o.width,o.height);else I.strokeRect(o.x,o.y,o.width,o.height);else I.fillRect(o.x,o.y,o.width,o.height);else S.pop(),h=S[S.length-1],I.setTransform(h[0],h[1],h[2],h[3],h[4],h[5]);else f=Math.cos(o.r),l=Math.sin(o.r),c=S[S.length-1],h=new Float64Array(c),h[0]=c[0]*f+c[2]*l,h[1]=c[1]*f+c[3]*l,h[2]=c[0]*-l+c[2]*f,h[3]=c[1]*-l+c[3]*f,S.push(h),I.setTransform(h[0],h[1],h[2],h[3],h[4],h[5]);else h=new Float64Array(S[S.length-1]),h[4]+=h[0]*o.x+h[2]*o.y,h[5]+=h[1]*o.x+h[3]*o.y,S.push(h),I.setTransform(h[0],h[1],h[2],h[3],h[4],h[5]);else h=new Float64Array(S[S.length-1]),h[0]*=o.x,h[1]*=o.x,h[2]*=o.y,h[3]*=o.y,S.push(h),I.setTransform(h[0],h[1],h[2],h[3],h[4],h[5]);else c=S[S.length-1],h=new Float64Array([c[0]*o.a+c[2]*o.b,c[1]*o.a+c[3]*o.b,c[0]*o.c+c[2]*o.d,c[1]*o.c+c[3]*o.d,c[0]*o.e+c[2]*o.f+c[4],c[1]*o.e+c[3]*o.f+c[5]]),S.push(h),I.setTransform(h[0],h[1],h[2],h[3],h[4],h[5])}return this.applyStyles()},i.create=function(t,e,n,r){return arguments.length>2?new i(t,e,n,r):2===arguments.length?new i(t,e):new i},i.prototype.workerCommand=function(e){var i,s=e.data;if(n||(n=t("./Canvas")),r||(r=t("./Gradient")),"ready"===s.type)return this.ready();if("image"===s.type)return i=new u(s.value.id),void(u.cache[s.value.id]=i);if("image-source"===s.type)return void(u.cache.hasOwnProperty(s.value.id)&&(i=u.cache[s.value.id],i.src=s.value.src,i.once("load",function(){this.sendWorker("image-load",s.value)}.bind(this))));if("image-cache"===s.type)return void(u.cache.hasOwnProperty(s.value.id)&&u.cache[s.value.id].cache());if("image-dispose"===s.type)return void(u.cache.hasOwnProperty(s.value.id)&&u.cache[s.value.id].dispose());if("render"===s.type)return void(this.tree=s.value);if("renderer-resize"===s.type)return this.resize(s.value.width,s.value.height);if("canvas"===s.type)return n.cache.hasOwnProperty(s.value.id)||(n.cache[s.value.id]=new n(s.value.width,s.value.height,s.value.id)),i=n.cache[s.value.id],i.resize(s.value.width,s.value.height),n.cache[s.value.id].render(s.value.children);if("canvas-image"===s.type&&n.cache.hasOwnProperty(s.value.id))return void n.cache[s.value.id].toImage(s.value.imageID);if("canvas-cache"===s.type)return void(n.cache.hasOwnProperty(s.value.id)&&n.cache[s.value.id]&&n.cache[s.value.id].cache());if("canvas-dispose"===s.type&&n.cache.hasOwnProperty(s.value.id)&&n.cache[s.value.id])return n.cache[s.value.id].dispose();if("linear-gradient"===s.type)return void(r.cache[s.value.id]=o(s.value.x0,s.value.y0,s.value.x1,s.value.y1,s.value.children,s.value.id));if("radial-gradient"===s.type)return void(r.cache[s.value.id]=a(s.value.x0,s.value.y0,s.value.r0,s.value.x1,s.value.y1,s.value.r1,s.value.children,s.value.id));if("gradient-dispose"!==s.type){if("gradient-cache"!==s.type)return"style"===s.type?this.style(s.value):"measureText"===s.type?this.measureText(s.value.font,s.value.text,null,s.value.id):this.emit(s.type,s.value);if(r.cache.hasOwnProperty(s.value.id))return r.cachable.push(s.value.id)}else if(r.cache.hasOwnProperty(s.value.id))return r.cache[s.value.id].dispose()},i.prototype.resize=function(t,e){return s?this.sendBrowser("renderer-resize",{width:t,height:e}):(""+this.canvas.width!=""+t&&(this.canvas.width=t),void(""+this.canvas.height!=""+e&&(this.canvas.height=e)))},i.prototype.hookRender=function(){return this.isReady&&(this.worker?null!==this.tree&&(this.lastMouseEvent&&!this.ranMouseEvent&&this.mouseMove(this.lastMouseEvent),this.fireFrame(),this.render(this.tree),this.tree=null):(this.lastMouseEvent&&!this.ranMouseEvent&&this.mouseMove(this.lastMouseEvent),this.fireFrame())),requestAnimationFrame(this.hookRender.bind(this))},i.prototype.cleanUpCache=function(){return u.cleanUp(),n.cleanUp(),r.cleanUp()},i.prototype.sendWorker=function(t,e){return this.worker?this.worker.postMessage({type:t,value:e}):this.emit(t,e)},i.prototype.sendBrowser=function(t,e){return postMessage({type:t,value:e})},i.prototype.sendAll=function(t,e){return s?this.sendBrowser(t,e):this.sendWorker(t,e),this.emit(t,e)},i.prototype.hookMouseEvents=function(){return document.addEventListener("mousemove",this.mouseMove.bind(this)),this.canvas.addEventListener("mousedown",this.mouseDown.bind(this)),document.addEventListener("mouseup",this.mouseUp.bind(this))},i.prototype.mouseMove=function(t){var e,i=this.canvas.getBoundingClientRect(),n=[0,0];this.lastMouseEvent=t,this.ranMouseEvent=!0,n[0]=t.clientX-i.left,n[1]=t.clientY-i.top;for(var r=0;r<this.mouseRegions.length;r++)e=this.mouseRegions[r],f(n,e.points)&&(this.activeRegions.push(e.id),this.mouseRegions.splice(this.mouseRegions.indexOf(e),1),r-=1);return this.mouseData.x=n[0],this.mouseData.y=n[1],this.mouseData.state=this.mouseState,this.mouseData.activeRegions=this.activeRegions,this.sendWorker("mouse",this.mouseData),t.preventDefault(),!1},i.prototype.mouseDown=function(t){return this.mouseState="down",this.mouseMove(t)},i.prototype.mouseUp=function(t){return this.mouseState="up",this.mouseMove(t)},i.prototype.hookKeyboardEvents=function(){for(var t in l.code)l.code.hasOwnProperty(t)&&(this.keyData[t]="up");return this.canvas.addEventListener("keydown",this.keyDown.bind(this)),document.addEventListener("keyUp",this.keyUp.bind(this))},i.prototype.keyChange=function(t){return this.sendWorker("key",this.keyData),t.preventDefault(),!1},i.prototype.keyDown=function(t){return this.keyData[l.code[t.keyCode]]="down",this.keyChange(t)},i.prototype.keyUp=function(t){return this.keyData[l.code[t.keyCode]]="up",this.keyChange(t)},i.prototype.browserCommand=function(t){return"image-load"===t.data.type&&u.cache[t.data.value.id].emit("load"),this.emit(t.data.type,t.data.value)},i.prototype.fireFrame=function(){return this.mouseRegions.splice(0,this.mouseRegions.length),this.sendWorker("frame",{}),this.activeRegions.splice(0,this.activeRegions.length),this.ranMouseEvent=!1,setTimeout(this.cleanUpCache.bind(this),0)},i.prototype.style=function(){var t,e,i,n=[],r=[],o=n.concat;for(e=0,t=arguments.length;t>e;e++)n.push(arguments[e]);for(e=0,t=n.length;t>e;e++){if(i=n[e],i&&i.constructor===Array){for(n=o.apply([],n),i=n[e];i&&i.constructor===Array;)n=o.apply([],n),i=n[e];t=n.length}i&&r.push(i)}if(s)this.sendBrowser("style",r);else for(e=0;e<r.length;e++)this.styleQueue.push(r[e])},i.prototype.applyStyles=function(){for(var t,e=0;e<this.styleQueue.length;e++){t=this.styleQueue[e];for(var i in t)t.hasOwnProperty(i)&&(this.canvas.style[i]=t[i])}this.styleQueue.splice(0,this.styleQueue.length)},i.prototype.ready=function(){return s?void this.sendBrowser("ready"):(this.isReady=!0,this.fireFrame(),requestAnimationFrame(this.hookRender.bind(this)))},i.prototype.measureText=function(t,e,i,n){if(n=n||v(),s)return this.sendBrowser("measureText",{font:t,text:e,id:n}),this.once("measureText-"+n,i);var r,o=this.ctx.font;return this.ctx.font=t,r=this.ctx.measureText(e),this.ctx.font=o,this.worker&&this.sendWorker("measureText-"+n,r),i&&"function"==typeof i?setTimeout(i.bind(null,r),0):void 0},Object.seal(i),Object.seal(i.prototype),e.exports=i},{"./Canvas":10,"./Gradient":11,"./Img":12,"./createLinearGradient":24,"./createRadialGradient":25,"./id":40,"./isWorker":42,"./transformPoints":59,events:1,keycode:8,"point-in-polygon":9,util:6}],15:[function(t,e){"use strict";function i(t,e){return new n("addColorStop",{offset:t,color:e})}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],16:[function(t,e){"use strict";function i(t,e,i,r,s,o){return arguments.length>5?new n(o?"anticlockwise-arc":"arc",{x:t,y:e,r:i,startAngle:r,endAngle:s}):5===arguments.length?new n("arc",{x:t,y:e,r:i,startAngle:r,endAngle:s}):arguments.length<3?arguments.length<1?new n("quick-arc",{r:1}):new n("quick-arc",{r:t}):new n("full-arc",{x:t,y:e,r:i})}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],17:[function(t,e){"use strict";function i(t,e,i,r,s){return new n("arcTo",{x1:t,y1:e,x2:i,y2:r,r:s})}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],18:[function(t,e){"use strict";function i(){return new n("beginPath")}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],19:[function(t,e){"use strict";function i(t,e,i,r,s,o){return new n("bezierCurveTo",{cp1x:t,cp1y:e,cp2x:i,cp2y:r,x:s,y:o})}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],20:[function(t,e){"use strict";function i(t,e,i,r){return arguments.length>2?new n("clearRect",{x:t,y:e,width:i,height:r}):new n("clearRect",{x:0,y:0,width:t,height:e})}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],21:[function(t,e){"use strict";function i(){for(var t=[n()],e=0;e<arguments.length;e++)t.push(arguments[e]);return t.push(r()),t}var n=t("./beginPath"),r=t("./clipPath");e.exports=i},{"./beginPath":18,"./clipPath":22}],22:[function(t,e){"use strict";function i(){return new n("clipPath")}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],23:[function(t,e){"use strict";function i(){return new n("closePath")}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],24:[function(t,e){"use strict";function i(t,e,i,o,a,c){if(c=c||s(),n)return postMessage({type:"linear-gradient",value:{id:c,x0:t,y0:e,x1:i,y1:o,children:a}}),new r(c,null);for(var h,u=document.createElement("canvas").getContext("2d"),l=u.createLinearGradient(t,e,i,o),d=new r(c,l),f=0;f<a.length;f++)h=a[f],l.addColorStop(h.props.offset,h.props.color);return d}var n=t("./isWorker"),r=t("./Gradient"),s=t("./id");e.exports=i},{"./Gradient":11,"./id":40,"./isWorker":42}],25:[function(t,e){"use strict";function i(t,e,i,o,a,c,h,u){if(u=u||s(),n)return postMessage({type:"radial-gradient",value:{id:u,x0:t,r0:i,y0:e,x1:o,y1:a,r1:c,children:h}}),new r(u,null);for(var l,d=document.createElement("canvas").getContext("2d"),f=d.createRadialGradient(t,e,i,o,a,c),p=new r(u,f),g=0;g<h.length;g++)l=h[g],f.addColorStop(l.props.offset,l.props.color);return p}var n=t("./isWorker"),r=t("./Gradient"),s=t("./id");e.exports=i},{"./Gradient":11,"./id":40,"./isWorker":42}],26:[function(t,e){"use strict";function i(t,e,i,r,s,o,a,c,h){return 9===arguments.length?new n("drawCanvasSource",{img:t.id,sx:e,sy:i,sWidth:r,sHeight:s,dx:o,dy:a,dWidth:c,dHeight:h}):arguments.length<5?arguments.length<3?new n("drawCanvas",{img:t.id,dx:0,dy:0}):new n("drawCanvas",{img:t.id,dx:e,dy:i}):new n("drawCanvasSize",{img:t.id,dx:e,dy:i,dWidth:r,dHeight:s})}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],27:[function(t,e){"use strict";function i(t,e,i,r,s,o,a,c,h){return 9===arguments.length?new n("drawImageSource",{img:t.id,sx:e,sy:i,sWidth:r,sHeight:s,dx:o,dy:a,dWidth:c,dHeight:h}):arguments.length<5?arguments.length<3?new n("drawImage",{img:t.id,dx:0,dy:0}):new n("drawImage",{img:t.id,dx:e,dy:i}):new n("drawImageSize",{img:t.id,dx:e,dy:i,dWidth:r,dHeight:s})}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],28:[function(t,e){"use strict";function i(t,e,i,r,s,o,a,c){return arguments.length>7?new n(c?"anticlockwise-ellipse":"ellipse",{x:t,y:e,radiusX:i,radiusY:r,startAngle:o,endAngle:a}):7===arguments.length?new n("ellipse",{x:t,y:e,radiusX:i,radiusY:r,rotation:s,startAngle:o,endAngle:a}):arguments.length<5?4===arguments.length?new n("quick-ellipse",{x:t,y:e,radiusX:i,radiusY:r}):new n("quick-ellipse",{x:0,y:0,radiusX:t,radiusY:e}):new n("full-ellipse",{x:t,y:e,radiusX:i,radiusY:r,rotation:s})}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],29:[function(t,e){"use strict";function i(){return new n("fill")}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],30:[function(t,e){"use strict";function i(t,e,i,s,o,a){return arguments.length>=6&&a?new n("fillArc-counterclockwise",{x:t,y:e,r:i,startAngle:s,endAngle:o}):arguments.length>3?new n("fillArc",{x:t,y:e,r:i,startAngle:s,endAngle:o}):arguments.length>1?new n("fillArc",{x:t,y:e,r:i,startAngle:0,endAngle:r}):new n("fillArc",{x:0,y:0,r:t,startAngle:0,endAngle:r})}var n=t("./Instruction"),r=2*Math.PI;e.exports=i},{"./Instruction":13}],31:[function(t,e){"use strict";function i(t,e,i,r,s,o,a,c,h){return 9===arguments.length?new n("fillCanvasSource",{img:t.id,sx:e,sy:i,sWidth:r,sHeight:s,dx:o,dy:a,dWidth:c,dHeight:h}):arguments.length<5?arguments.length<3?new n("fillCanvas",{img:t.id,dx:0,dy:0}):new n("fillCanvas",{img:t.id,dx:e,dy:i}):new n("fillCanvasSize",{img:t.id,dx:e,dy:i,dWidth:r,dHeight:s})}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],32:[function(t,e){"use strict";function i(t,e,i,r,s,o,a,c,h){return 9===arguments.length?new n("fillImageSource",{img:t.id,sx:e,sy:i,sWidth:r,sHeight:s,dx:o,dy:a,dWidth:c,dHeight:h}):arguments.length<5?arguments.length<3?new n("fillImage",{img:t.id,dx:0,dy:0}):new n("fillImage",{img:t.id,dx:e,dy:i}):new n("fillImageSize",{img:t.id,dx:e,dy:i,dWidth:r,dHeight:s})}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],33:[function(t,e){"use strict";function i(t,e,i,r,s){return arguments.length<5?arguments.length<3?new n("fillImagePattern",{img:t.id,dx:0,dy:0,dWidth:0,dHeight:0}):new n("fillImagePattern",{img:t.id,dx:0,dy:0,dWidth:e,dHeight:i}):new n("fillImagePattern",{img:t.id,dx:e,dy:i,dWidth:r,dHeight:s})}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],34:[function(t,e){"use strict";function i(t,e,i,r){return arguments.length<4?new n("fillRect",{x:0,y:0,width:t,height:e}):new n("fillRect",{x:t,y:e,width:i,height:r})}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],35:[function(t,e){"use strict";function i(t){var e;t instanceof r&&(e=new n("fillGradient",{value:{id:t.id}})),e||(e=new n("fillStyle",{value:t}));for(var i=[e],s=1;s<arguments.length;s++)i.push(arguments[s]);return i.push(new n("endFillStyle")),i}var n=t("./Instruction"),r=t("./Gradient");e.exports=i},{"./Gradient":11,"./Instruction":13}],36:[function(t,e){"use strict";function i(t){for(var e=[new n("globalAlpha",{value:t})],i=1;i<arguments.length;i++)e.push(arguments[i]);return e.push(new n("endGlobalAlpha")),e}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],37:[function(t,e){"use strict";function i(t){var e=[new n("globalCompositeOperation",{value:t})];if(0===arguments.length)return[];for(var i=1;i<arguments.length;i++)e.push(arguments[i]);return e.push(new n("endGlobalCompositeOperation")),e}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],38:[function(t,e){"use strict";function i(t,e,i,r,s){arguments.length>3||(r=e,s=i,e=0,i=0);var o=[[e,i],[e,i+s],[e+r,i+s],[e+r,i]];return n(t,o)}var n=(t("./Instruction"),t("./hitRegion"));e.exports=i},{"./Instruction":13,"./hitRegion":39}],39:[function(t,e){"use strict";function i(t,e){return new n("hitRegion",{id:t,points:e})}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],40:[function(t,e){"use strict";function i(){return Date.now()+"-"+Math.random()}e.exports=i},{}],41:[function(t,e){function i(t){return!!t.match(i.regex)}i.regex=/^\s*data:([a-z]+\/[a-z]+(;[a-z\-]+\=[a-z\-]+)?)?(;base64)?,[a-z0-9\!\$\&\'\,\(\)\*\+\,\;\=\-\.\_\~\:\@\/\?\%\s]*\s*$/i,Object.seal(i),e.exports=i},{}],42:[function(t,e){"use strict";e.exports="undefined"==typeof document},{}],43:[function(t,e){"use strict";function i(t){t=t||{};var e={lineWidth:null,lineCap:null,lineJoin:null,miterLimit:null,lineDash:[],lineDashOffset:null};void 0!==t.lineWidth&&(e.lineWidth=t.lineWidth),void 0!==t.lineCap&&(e.lineCap=t.lineCap),void 0!==t.lineJoin&&(e.lineJoin=t.lineJoin),void 0!==t.miterLimit&&(e.miterLimit=t.miterLimit),void 0!==t.lineDash&&(e.lineDash=t.lineDash),void 0!==t.lineDashOffset&&(e.lineDashOffset=t.lineDashOffset);for(var i=[new n("lineStyle",e)],r=1;r<arguments.length;r++)i.push(arguments[r]);return i.push(new n("endLineStyle")),i}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],44:[function(t,e){"use strict";function i(t,e){return 0===arguments.length?new n("lineTo",{x:0,y:0}):new n("lineTo",{x:t,y:e})}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],45:[function(t,e){"use strict";function i(t,e){return 0===arguments.length?new n("moveTo",{x:0,y:0}):new n("moveTo",{x:t,y:e})}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],46:[function(t,e){"use strict";function i(){for(var t=[n()],e=0;e<arguments.length;e++)t.push(arguments[e]);return t.push(r()),t}var n=t("./beginPath"),r=t("./closePath");e.exports=i},{"./beginPath":18,"./closePath":23}],47:[function(t,e){"use strict";function i(t,e,i,r){return new n("quadraticCurveTo",{cpx:t,cpy:e,x:i,y:r})}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],48:[function(t,e){"use strict";function i(t,e,i,r){return arguments.length>2?new n("rect",{x:t,y:e,width:i,height:r}):new n("rect",{x:0,y:0,width:t,height:e})}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],49:[function(t,e){"use strict";function i(t){t=+t;for(var e=[new n("rotate",{r:t})],i=1;i<arguments.length;i++)e.push(arguments[i]);return e.push(new n("restore")),e}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],50:[function(t,e){"use strict";function i(t,e,i){var r=2;"number"!=typeof e&&(e=t,r=1),i=i||[];for(var s=[new n("scale",{x:t,y:e})];r<arguments.length;r++)s.push(arguments[r]);return s.push(new n("restore")),s}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],51:[function(t,e){"use strict";function i(t){t=t||{};var e={shadowBlur:null,shadowColor:null,shadowOffsetX:null,shadowOffsetY:null};void 0!==t.shadowBlur&&(e.shadowBlur=t.shadowBlur),void 0!==t.shadowColor&&(e.shadowColor=t.shadowColor),void 0!==t.shadowOffsetX&&(e.shadowOffsetX=t.shadowOffsetX),void 0!==t.direction&&(e.shadowOffsetY=t.shadowOffsetY);for(var i=[new n("shadowStyle",t)],r=1;r<arguments.length;r++)i.push(arguments[r]);return i.push(new n("endShadowStyle")),i}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],52:[function(t,e){"use strict";function i(){return new n("stroke")}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],53:[function(t,e){"use strict";function i(t,e,i,s,o,a){return arguments.length>=6&&a?new n("strokeArc-counterclockwise",{x:t,y:e,r:i,startAngle:s,endAngle:o}):arguments.length>3?new n("strokeArc",{x:t,y:e,r:i,startAngle:s,endAngle:o}):arguments.length>1?new n("strokeArc",{x:t,y:e,r:i,startAngle:0,endAngle:r}):new n("strokeArc",{x:0,y:0,r:t,startAngle:0,endAngle:r})}var n=t("./Instruction"),r=2*Math.PI;e.exports=i},{"./Instruction":13}],54:[function(t,e){"use strict";function i(t,e,i,r){return arguments.length>2?new n("strokeRect",{x:t,y:e,width:i,height:r}):new n("strokeRect",{x:0,y:0,width:t,height:e})
}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],55:[function(t,e){"use strict";function i(t){var e;t instanceof r&&(e=new n("strokeGradient",{value:{id:t.id}})),e||(e=new n("strokeStyle",{value:t}));for(var i=[e],s=1;s<arguments.length;s++)i.push(arguments[s]);return i.push(new n("endStrokeStyle")),i}var n=t("./Instruction"),r=t("./Gradient");e.exports=i},{"./Gradient":11,"./Instruction":13}],56:[function(t,e){"use strict";function i(t,e,i,r,s,o){return 6===arguments.length?new n("text",{x:e,y:i,fill:r,stroke:s,text:t,maxWidth:o}):5===arguments.length?new n("text",{x:e,y:i,fill:r,stroke:s,text:t,maxWidth:0}):4===arguments.length?new n("text",{x:e,y:i,fill:r,stroke:!1,text:t,maxWidth:0}):3===arguments.length?new n("text",{x:e,y:i,fill:!0,stroke:!1,text:t,maxWidth:0}):new n("text",{x:0,y:0,fill:!0,stroke:!1,text:t,maxWidth:0})}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],57:[function(t,e){"use strict";function i(t){t=t||{};var e={font:null,textAlign:null,textBaseline:null,direction:null};void 0!==t.font&&(e.font=t.font),void 0!==t.textAlign&&(e.textAlign=t.textAlign),void 0!==t.textBaseline&&(e.textBaseline=t.textBaseline),void 0!==t.direction&&(e.direction=t.direction);for(var i=[new n("textStyle",t)],r=1;r<arguments.length;r++)i.push(arguments[r]);return i.push(new n("endTextStyle")),i}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],58:[function(t,e){"use strict";function i(t){var e,i,r,s,o,a,c,h,u=new Float64Array([1,0,0,1,0,0]),l=t.length;for(i=0;l>i;i++)e=t[i],e.hasOwnProperty("transform")?(u[0]=u[0]*e.transform.a+u[2]*e.transform.b,u[1]=u[1]*e.transform.a+u[3]*e.transform.b,u[2]=u[0]*e.transform.c+u[2]*e.transform.d,u[3]=u[1]*e.transform.c+u[3]*e.transform.d,u[4]=u[0]*e.transform.e+u[2]*e.transform.f+u[4],u[5]=u[1]*e.transform.e+u[3]*e.transform.f+u[5]):(e.hasOwnProperty("translate")&&(o=e.translate.x,a=e.translate.y,u[4]+=u[0]*o+u[2]*a,u[5]+=u[1]*o+u[3]*a),e.hasOwnProperty("scale")&&(o=e.scale.x,a=e.scale.y,u[0]*=o,u[1]*=o,u[2]*=a,u[3]*=a),e.hasOwnProperty("rotate")&&(s=Math.sin(e.rotate),r=Math.cos(e.rotate),u[0]=u[0]*r+u[2]*-s,u[1]=u[1]*r+u[3]*-s,u[2]=u[0]*s+u[2]*r,u[3]=u[1]*s+u[3]*r));for(c={a:u[0],b:u[1],c:u[2],d:u[3],e:u[4],f:u[5]},h=[new n("transform",c)],i=1,l=arguments.length;l>i;i++)h.push(arguments[i]);return h.push(new n("restore")),h}var n=t("./Instruction");e.exports=i},{"./Instruction":13}],59:[function(t,e){"use strict";function i(t,e){for(var i,n=[],r=t.length,s=0;r>s;s++)i=t[s],n.push([e[0]*i[0]+e[2]*i[1]+e[4],e[1]*i[0]+e[3]*i[1]+e[5]]);return n}e.exports=i},{}],60:[function(t,e){"use strict";function i(t,e){for(var i,r=[new n("translate",{x:t,y:e})],s=2;s<arguments.length;s++)i=arguments[s],Array.isArray(i)?r=r.concat(i):r.push(arguments[s]);return r.push(new n("restore")),r}var n=t("./Instruction");e.exports=i},{"./Instruction":13}]},{},[7])(7)});